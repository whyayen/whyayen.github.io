(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{498:function(e,n,t){"use strict";t.r(n);var s=t(4),a=Object(s.a)({},(function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h2",{attrs:{id:"前言"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[e._v("#")]),e._v(" 前言")]),e._v(" "),t("p",[e._v("最近因為使用 MySQL 的 JSON Aggregate 的一些 function，發現原系統是 "),t("code",[e._v("5.7.21")]),e._v("，但 JSON Aggregate Functions 在 "),t("code",[e._v("5.7.22")]),e._v(" 才支援，加上系統有點舊，無法順利更新上 "),t("code",[e._v("5.7.32")]),e._v("，想說直接開一台較新的作業系統 (Ubuntu 18.04)，安裝新版 "),t("code",[e._v("5.7.32")]),e._v("，在進行一些設定時，發現 "),t("code",[e._v("5.7")]),e._v(" 版的 MySQL 設定好繚亂，不是很清楚要設定哪個 configuration file。")]),e._v(" "),t("h2",{attrs:{id:"版本差異"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#版本差異"}},[e._v("#")]),e._v(" 版本差異")]),e._v(" "),t("p",[e._v("在 "),t("code",[e._v("/etc/mysql")]),e._v(" 底下有下列這些檔案：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("- my.cnf\n- my.cnf.fallback \n- mysql.cnf\n> conf.d\n - mysql.cnf\n - mysqldump.cnf\n> mysql.conf.d\n - mysqld.cnf\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br")])]),t("p",[e._v("首先有 "),t("code",[e._v("my.cnf")]),e._v(" 及 "),t("code",[e._v("mysql.cnf")]),e._v(" 這兩個檔案，究竟有何差異？\n透過指令我們可以發現 "),t("code",[e._v("my.cnf")]),e._v(" 其實是 link 到 "),t("code",[e._v("/etc/alternatives/my.cnf")]),e._v("。")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("my.cnf -> /etc/alternatives/my.cnf\nmysql.cnf\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br")])]),t("p",[e._v("再查看一下 "),t("code",[e._v("/etc/alternatives/my.cnf")]),e._v("，可以發現是 link 回 "),t("code",[e._v("/etc/mysql/mysql.cnf")]),e._v("。")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("/etc/alternatives/my.cnf -> /etc/mysql/mysql.cnf\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("所以無論你改 "),t("code",[e._v("/etc/mysql/mysql.cnf")]),e._v(" 或 "),t("code",[e._v("/etc/mysql/my.cnf")]),e._v(" 其實他們都是長一樣的。接著我們再來看 "),t("code",[e._v("/etc/mysql/mysql.cnf")]),e._v(" 裡面的內容：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("!includedir /etc/mysql/conf.d/\n!includedir /etc/mysql/mysql.conf.d/\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br")])]),t("p",[e._v("會把所有 "),t("code",[e._v("/etc/mysql/conf.d/")]),e._v(" 及 "),t("code",[e._v("/etc/mysql/mysql.conf.d/")]),e._v(" 裡面的 "),t("code",[e._v(".cnf")]),e._v(" 檔案匯入，但 "),t("code",[e._v("conf.d/")]),e._v(" 跟 "),t("code",[e._v("mysql.conf.d")]),e._v(" 的差異是什麼呢？查到一個"),t("a",{attrs:{href:"https://serverfault.com/a/954306",target:"_blank",rel:"noopener noreferrer"}},[e._v("討論"),t("OutboundLink")],1),e._v("是說：")]),e._v(" "),t("blockquote",[t("p",[e._v("!includedir /etc/mysql/mysql.conf.d/ is an SYSCONFDIR generate by ubuntu when Mysql was compiling for the package in CMAKE option.")])]),e._v(" "),t("p",[e._v("以及這個答案的第一個 comment：")]),e._v(" "),t("blockquote",[t("p",[e._v("Thanks for your reply. So I understand that /etc/mysql/mysql.conf.d is there just for retrocompatibility and /etc/mysql/conf.d is the way to go, right?")])]),e._v(" "),t("p",[e._v("在經過我自己的一些測試後，發現 "),t("code",[e._v("mysql.conf.d")]),e._v(" 資料夾是在 "),t("code",[e._v("5.7")]),e._v(" 版本才出現的，我起兩台全新的 Ubuntu 14.04 Server，分別安裝 MySQL "),t("code",[e._v("5.5")]),e._v(" 跟 "),t("code",[e._v("5.6")]),e._v("，"),t("code",[e._v("/etc/mysql")]),e._v(" 下只有 "),t("code",[e._v("conf.d")]),e._v(" 資料夾，並沒有 "),t("code",[e._v("mysql.conf.d")]),e._v("，\b再\b起一台 Ubuntu 18.04 Server 安裝 MySQL "),t("code",[e._v("5.7")]),e._v(" 才出現 "),t("code",[e._v("mysql.conf.d")]),e._v("。")]),e._v(" "),t("p",[e._v("另外在 "),t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/using-systemd.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("MySQL 5.7 Reference Manual - 2.5.10 Managing MySQL Server with systemd"),t("OutboundLink")],1),e._v(" 文件有提到")]),e._v(" "),t("blockquote",[t("p",[e._v("To use multiple-instance capability, modify the my.cnf option file to include configuration of key options for each instance. These file locations are typical:")]),e._v(" "),t("ul",[t("li",[e._v("/etc/my.cnf or /etc/mysql/my.cnf (RPM platforms)")]),e._v(" "),t("li",[e._v("/etc/mysql/mysql.conf.d/mysqld.cnf (Debian platforms)")])])]),e._v(" "),t("p",[e._v("官方文件寫到可以使用 "),t("code",[e._v("multiple-instance capability")]),e._v(" 可以修改 my.cnf option file，雖然不是在 option file 的章節裡面寫，而是在一個奇怪的地方寫 option file 一般存放的地方，但從這裡我們可以發現，官方有說一般這個檔案在 RPM 跟 Debian 系統的路徑在哪。")]),e._v(" "),t("h2",{attrs:{id:"結論"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#結論"}},[e._v("#")]),e._v(" 結論")]),e._v(" "),t("p",[e._v("我們可以發現 "),t("code",[e._v("5.7")]),e._v(" 版本會出現 "),t("code",[e._v("mysql.conf.d")]),e._v(" 資料夾，加上官方文件有提及 Debian 平台可以修改 "),t("code",[e._v("/etc/mysql/mysql.conf.d/mysqld.cnf")]),e._v("，所以我個人理解為 Debian 平台 "),t("code",[e._v("/etc/mysql/mysql.conf.d/mysqld.cnf")]),e._v(" 是官方建議修改的地方，而 "),t("code",[e._v("conf.d")]),e._v(" 是為兼容舊版使用。")]),e._v(" "),t("p",[e._v("當然在新系統安裝完 MySQL "),t("code",[e._v("5.7")]),e._v(" 後，可以發現只有 "),t("code",[e._v("/etc/mysql/mysql.conf.d/mysqld.cnf")]),e._v(" 裡面有詳細的設定，而 "),t("code",[e._v("/etc/mysql/conf.d/my.cnf")]),e._v(" 是空的，但對於 MySQL 從 "),t("code",[e._v("5.6")]),e._v(" 升級上來的，可能就有彼此改在不同檔案的問題，最好的方式還是團隊溝通、建立共識改單一一個 configuration file，避免造成設定被覆蓋，是比較重要的。")]),e._v(" "),t("h2",{attrs:{id:"參考資料"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#參考資料"}},[e._v("#")]),e._v(" 參考資料")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/option-files.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("MySQL 5.7 Reference Manual - 4.2.2.2 Using Option Files"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/using-systemd.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("MySQL 5.7 Reference Manual - 2.5.10 Managing MySQL Server with systemd"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://serverfault.com/a/954306",target:"_blank",rel:"noopener noreferrer"}},[e._v("MySQL 8 on Ubuntu: what's the difference between /etc/mysql/conf.d/ and /etc/mysql/mysql.conf.d/?"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);n.default=a.exports}}]);